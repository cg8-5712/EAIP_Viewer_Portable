# EAIP Viewer

一个基于 Python Qt6 + QML 的跨平台航图查看器应用程序。

![CI](https://github.com/your-username/EAIP_Viewer_portable/workflows/CI/badge.svg)
![Release](https://github.com/your-username/EAIP_Viewer_portable/workflows/Build%20and%20Release/badge.svg)

## 功能特性

### 核心功能
- **启动画面**：应用启动时展示精美的加载封面，提升品牌体验
- **数据导入**：支持导入压缩包（.zip）作为数据源，自动解压和处理
- **机场列表**：首页显示所有可用机场的列表
- **分类浏览**：按类型分类浏览航图（AD、SID、STAR、APP 等）
- **PDF 查看**：内置 PDF 查看器，支持缩放、平移等操作
- **航图固定**：底部 Pin 栏可固定最多 10 张常用航图，快速切换
- **国际化支持**：多语言界面切换（中文简体/繁体、英文）
- **主题定制**：浅色/深色主题切换，自定义强调色

### 跨平台支持
- Windows 10/11
- Linux (Ubuntu 20.04+)
- macOS (10.15+)

## 技术架构

### 技术栈
- **语言**：Python 3.10+
- **GUI 框架**：PySide6 (Qt6)
- **界面**：QML (Qt Quick)
- **PDF 渲染**：PyMuPDF (fitz) / QPdfDocument
- **数据处理**：自定义数据解析模块
- **国际化**：Qt Linguist / QML i18n

### 项目结构
```
EAIP_Viewer_portable/
├── src/
│   ├── main.py                 # 应用程序入口
│   ├── models/
│   │   ├── __init__.py
│   │   ├── airport_model.py    # 机场数据模型
│   │   ├── chart_model.py      # 航图数据模型
│   │   └── pin_model.py        # 固定航图模型
│   ├── controllers/
│   │   ├── __init__.py
│   │   ├── data_manager.py     # 数据导入和处理
│   │   ├── pdf_handler.py      # PDF 处理
│   │   └── app_controller.py   # 主控制器
│   ├── utils/
│   │   ├── __init__.py
│   │   ├── zip_extractor.py    # 压缩包处理
│   │   └── config.py           # 配置管理
│   ├── qml/
│   │   ├── main.qml            # 主窗口
│   │   ├── SplashScreen.qml    # 启动画面
│   │   ├── AirportList.qml     # 机场列表页面
│   │   ├── ChartViewer.qml     # 航图查看器页面
│   │   ├── components/
│   │   │   ├── CategoryList.qml    # 分类列表组件
│   │   │   ├── ChartList.qml       # 航图列表组件
│   │   │   ├── PdfViewer.qml       # PDF 查看器组件
│   │   │   └── PinBar.qml          # Pin 栏组件
│   │   └── styles/
│   │       ├── AppStyle.qml        # 应用样式
│   │       └── ThemeManager.qml    # 主题管理
│   ├── i18n/
│   │   ├── zh_CN.ts            # 简体中文
│   │   ├── zh_TW.ts            # 繁体中文
│   │   └── en_US.ts            # 英文
│   └── resources/
│       ├── images/
│       │   ├── splash_logo.svg     # 启动画面 Logo
│       │   ├── app_icon.png        # 应用图标
│       │   └── placeholder.png     # 占位图
│       └── fonts/              # 自定义字体（可选）
├── data/                       # 数据目录（解压后的数据）
├── cache/                      # 缓存目录
├── config/                     # 配置文件
├── requirements.txt            # Python 依赖
├── .gitignore                  # Git 忽略文件
└── README.md                   # 项目说明
```

## 界面设计（现代化风格）

### 设计语言
- **风格**：现代扁平化设计，融合 Material Design 和 Fluent Design 元素
- **色彩**：深色/浅色主题切换，支持自定义强调色（默认航空蓝 #1976D2）
- **布局**：卡片式布局，流畅动画过渡
- **交互**：悬浮阴影、毛玻璃效果、响应式设计
- **国际化**：支持中文（简体/繁体）、英文，界面文字动态切换

### 0. 启动画面（Splash Screen）

应用启动时显示的加载封面，展示品牌标识并初始化应用资源。

```
┌─────────────────────────────────────────────────┐
│                                                 │
│                                                 │
│                                                 │
│               ╔═══════════════╗                 │
│               ║               ║                 │
│               ║   ✈️  航图     ║                 │
│               ║               ║                 │
│               ╚═══════════════╝                 │
│                                                 │
│            EAIP Viewer                          │
│        Electronic Aeronautical                  │
│      Information Publication Viewer             │
│                                                 │
│                   v1.0.0                        │
│                                                 │
│            ▰▰▰▰▰▱▱▱▱▱                          │
│             加载中... 60%                        │
│                                                 │
│                                                 │
│     Powered by Python & Qt6                     │
│                                                 │
└─────────────────────────────────────────────────┘
```

**设计特性：**
- **居中 Logo**：飞机图标 + "航图" 文字，简洁大气
- **应用名称**：EAIP Viewer + 英文全称
- **版本信息**：显示当前应用版本
- **加载进度**：动画进度条 + 百分比提示
- **渐变背景**：蓝色渐变（航空主题），跟随系统主题调整
- **淡入淡出**：启动 500ms 淡入，完成后 300ms 淡出到主界面
- **最小显示时间**：至少显示 1.5 秒，确保用户看到品牌

**启动流程：**
```
应用启动 → 显示启动画面 (淡入)
  → 初始化配置 (20%)
  → 加载主题/语言 (40%)
  → 初始化数据库 (60%)
  → 加载已保存数据 (80%)
  → 预加载组件 (100%)
  → 淡出 → 进入主界面
```

### 1. 主窗口布局
```
╔═══════════════════════════════════════════════════════════╗
║  ✈ EAIP Viewer                    🔍 搜索  📦 导入  ⚙ 设置 ║
║                                                           ║
║  ┌─────────────────────────────────────────────────────┐ ║
║  │                                                     │ ║
║  │               [页面路由区域]                         │ ║
║  │           流畅的页面切换动画                         │ ║
║  │                                                     │ ║
║  └─────────────────────────────────────────────────────┘ ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝
```

### 2. 机场列表页面（卡片式布局）
```
╔═══════════════════════════════════════════════════════════╗
║  机场列表                                    🔍 [搜索框]   ║
╟───────────────────────────────────────────────────────────╢
║                                                           ║
║  ╭─────────────────────────────────────────────────────╮ ║
║  │  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓  │ ║
║  │  ┃  🛫 ZBAA                              →      ┃  │ ║
║  │  ┃  北京首都国际机场                              ┃  │ ║
║  │  ┃  Beijing Capital International Airport       ┃  │ ║
║  │  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  │ ║
║  │                                                     │ ║
║  │  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓  │ ║
║  │  ┃  🛫 ZSPD                              →      ┃  │ ║
║  │  ┃  上海浦东国际机场                              ┃  │ ║
║  │  ┃  Shanghai Pudong International Airport       ┃  │ ║
║  │  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  │ ║
║  │                                                     │ ║
║  │  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓  │ ║
║  │  ┃  🛫 ZGGG                              →      ┃  │ ║
║  │  ┃  广州白云国际机场                              ┃  │ ║
║  │  ┃  Guangzhou Baiyun International Airport      ┃  │ ║
║  │  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  │ ║
║  ╰─────────────────────────────────────────────────────╯ ║
║                                                           ║
╚═══════════════════════════════════════════════════════════╝
```

### 3. 航图查看页面（三栏布局 + 毛玻璃 Pin 栏）
```
╔════════════════════════════════════════════════════════════════════╗
║  ← ZBAA - 北京首都国际机场                   🔍 搜索  ⚙ 设置      ║
╟────────────────────────────────────────────────────────────────────╢
║                                                                    ║
║  ┌──────┐  ┌───────────┐  ┌───────────────────────────────────┐  ║
║  │ 分类 │  │  航图列表  │  │       PDF 查看区域                 │  ║
║  │      │  │           │  │                                   │  ║
║  │ ┏━━┓ │  │  ┏━━━━━┓  │  │  ╔═══════════════════════════════╗ │  ║
║  │ ┃AD┃ │  │  ┃AD1.1┃  │  │  ║                               ║ │  ║
║  │ ┗━━┛ │  │  ┗━━━━━┛  │  │  ║     [PDF 预览缩略图]           ║ │  ║
║  │      │  │           │  │  ║                               ║ │  ║
║  │ ┌──┐ │  │  ┌─────┐  │  │  ║     [PDF 渲染内容]            ║ │  ║
║  │ │SD│ │  │  │AD1.2│  │  │  ║                               ║ │  ║
║  │ └──┘ │  │  └─────┘  │  │  ║     滚轮缩放 / 拖拽平移         ║ │  ║
║  │      │  │           │  │  ║                               ║ │  ║
║  │ ┌──┐ │  │  ┌─────┐  │  │  ╠═══════════════════════════════╣ │  ║
║  │ │ST│ │  │  │AD2.1│  │  │  ║  [🔍 放大] [缩小] [适应] [旋转] ║ │  ║
║  │ └──┘ │  │  └─────┘  │  │  ╚═══════════════════════════════╝ │  ║
║  │      │  │           │  │                                   │  ║
║  │ ┌──┐ │  │           │  │                                   │  ║
║  │ │AP│ │  │           │  │                                   │  ║
║  │ └──┘ │  │           │  │                                   │  ║
║  └──────┘  └───────────┘  └───────────────────────────────────┘  ║
║                                                                    ║
╟────────────────────────────────────────────────────────────────────╢
║  📌 固定航图 (毛玻璃效果)                                          ║
║  ╔═══╗ ╔═══╗ ╔═══╗ ┌───┐ ┌───┐ ┌───┐      ┌─────┐               ║
║  ║图1║ ║图2║ ║图3║ │   │ │   │ │   │ ...  │ + 添加│   (最多10个) ║
║  ╚═══╝ ╚═══╝ ╚═══╝ └───┘ └───┘ └───┘      └─────┘               ║
╚════════════════════════════════════════════════════════════════════╝
```

### 4. 设计细节

#### 颜色方案

**基础主题**

- **浅色主题**：
  - 背景：#FAFAFA
  - 卡片：#FFFFFF (阴影: 0 2px 8px rgba(0,0,0,0.1))
  - 文字：#212121 / #757575
  - 默认强调色：#1976D2 (航空蓝)

- **深色主题**：
  - 背景：#121212
  - 卡片：#1E1E1E (阴影: 0 2px 8px rgba(0,0,0,0.5))
  - 文字：#FFFFFF / #B0B0B0
  - 默认强调色：#42A5F5 (浅蓝)

**可选强调色方案**

用户可在设置中自定义强调色，预设包括：

| 颜色名称 | 浅色主题 | 深色主题 | 适用场景 |
|---------|---------|---------|---------|
| 航空蓝 (默认) | #1976D2 | #42A5F5 | 专业、航空 |
| 天空蓝 | #0288D1 | #29B6F6 | 清爽、现代 |
| 翠绿 | #388E3C | #66BB6A | 舒适、自然 |
| 深紫 | #5E35B1 | #7E57C2 | 优雅、科技 |
| 琥珀橙 | #F57C00 | #FFA726 | 活力、警示 |
| 玫红 | #C2185B | #F06292 | 个性、突出 |
| 深灰 | #455A64 | #78909C | 简约、低调 |

#### 动画效果
- 页面切换：淡入淡出 + 滑动 (300ms)
- 卡片悬浮：阴影加深 + 轻微上浮 (200ms)
- 列表展开：高度动画 (250ms)
- Pin 栏滑入：底部滑入 (400ms)

#### 交互反馈
- 按钮：涟漪效果 (Material Design)
- 悬浮：轻微缩放 (scale: 1.02)
- 选中：左侧蓝色边框 (4px)
- 拖拽：半透明跟随

## 数据流程

### 1. 数据导入流程
```
压缩包 → 解压 → 数据处理（用户提供）→ 解析结构 → 保存到本地
```

### 2. 导航流程
```
机场列表 → 选择机场 → 分类列表 → 航图列表 → PDF 显示
```

### 3. Pin 功能
```
航图查看 → 添加到 Pin → Pin 栏显示 → 快速切换
```

## 依赖项

```txt
PySide6>=6.6.0
PyMuPDF>=1.23.0
```

## 开发计划

### Phase 1: 基础框架
- [ ] Qt6 + QML 基础框架搭建
- [ ] 启动画面（Splash Screen）实现
- [ ] 主窗口和路由系统
- [ ] 基本的数据模型
- [ ] 主题管理系统（ThemeManager）
- [ ] 国际化框架集成

### Phase 2: 数据处理
- [ ] 压缩包导入功能
- [ ] 数据解析和处理集成
- [ ] 机场和航图数据模型

### Phase 3: UI 实现
- [ ] 机场列表页面
- [ ] 航图查看页面（三栏布局）
- [ ] PDF 查看器组件
- [ ] Pin 栏组件
- [ ] 设置页面（主题/语言切换）

### Phase 4: 国际化与主题
- [ ] 翻译文件编写（中文简体/繁体、英文）
- [ ] 动态语言切换实现
- [ ] 多主题色方案实现
- [ ] 主题自动切换（跟随系统）
- [ ] 配置持久化
- [ ] 启动画面多语言支持

### Phase 5: 功能完善
- [ ] 搜索功能
- [ ] 配置管理
- [ ] 缓存优化
- [ ] 跨平台测试

### Phase 6: 打包发布
- [ ] PyInstaller 打包配置（可选）
- [ ] 应用图标和启动画面资源
- [ ] Windows 可执行文件（.exe）
- [ ] Linux 可执行文件
- [ ] macOS 应用包（.app）

## 使用说明

### 1. 安装依赖（不使用虚拟环境）
```bash
pip install -r requirements.txt
```

### 2. 运行应用
```bash
python src/main.py
```

或在项目根目录直接双击运行脚本（Windows）：
```bash
python src\main.py
```

### 3. 退出应用
- 快捷键：`Ctrl+Q`
- 全屏切换：`F11`

## 配置说明

### 数据源格式
压缩包应包含以下结构：
```
data.zip
├── airports/
│   ├── ZBAA/
│   │   ├── AD/
│   │   ├── SID/
│   │   ├── STAR/
│   │   └── APP/
│   └── ZSPD/
│       └── ...
└── metadata.json
```

### 配置文件
`config/settings.json`:
```json
{
  "data_path": "./data",
  "cache_path": "./cache",
  "max_pins": 10,
  "pdf_render_dpi": 150,
  "language": "zh_CN",
  "theme": {
    "mode": "light",
    "accent_color": "aviation_blue"
  },
  "splash_screen": {
    "enabled": true,
    "min_display_time": 1500
  }
}
```

**配置说明**：
- `language`: 界面语言
  - `zh_CN`: 简体中文
  - `zh_TW`: 繁体中文
  - `en_US`: 英文
- `theme.mode`: 主题模式
  - `light`: 浅色主题
  - `dark`: 深色主题
  - `auto`: 跟随系统
- `theme.accent_color`: 强调色名称
  - `aviation_blue` (默认)
  - `sky_blue`
  - `green`
  - `purple`
  - `amber`
  - `pink`
  - `gray`
  - 或自定义 HEX 色值（如 "#1976D2"）
- `splash_screen.enabled`: 是否显示启动画面
- `splash_screen.min_display_time`: 最小显示时间（毫秒）

## 许可证

待定

## 贡献指南

待定